---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import { aggregateRSSFeeds } from '../utils/rss-aggregator';

// Get all RSS updates (no limit)
const allRSSUpdates = await aggregateRSSFeeds(50); // Show up to 50 updates
---

<Layout
  title="All Updates - Bhuvan"
  description="All updates from across my projects"
>
  <Header />

  <div class="list-page">
    <div class="container">
      <div class="list-header">
        <h1 class="list-title">All Updates</h1>
        <p class="list-description">Latest posts and updates from across all my projects</p>
      </div>

      <div class="rss-updates">
        {allRSSUpdates.map((update) => (
          <article class="rss-update-card">
            <div class="update-header">
              <span class="update-source">{update.source}</span>
              <time class="update-date">
                {update.pubDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}
              </time>
            </div>
            <h3 class="update-title">
              <a href={update.link} target="_blank" rel="noopener noreferrer">
                {update.title}
              </a>
            </h3>
            <p class="update-excerpt">{update.excerpt}</p>
            <a href={update.link} target="_blank" rel="noopener noreferrer" class="update-link">
              Read more â†’
            </a>
          </article>
        ))}
      </div>
    </div>
  </div>

  <Footer />
</Layout>
